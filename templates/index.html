<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Usuarios</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <h1>Gráficos de Series Trigonométricas por Usuario</h1>

    <!-- Select para escoger el usuario -->
    <label for="usuario">Seleccionar Usuario:</label>
    <select id="usuario" onchange="cargarGraficos()">
        <!-- Aquí se cargarán los usuarios desde el servidor -->
    </select>

    <!-- Divs para mostrar los gráficos -->
    <div id="grafico_seno" style="width:100%;height:400px;"></div>
    <div id="grafico_coseno" style="width:100%;height:400px;"></div>
    <div id="grafico_fourier" style="width:100%;height:400px;"></div>
    <div id="grafico_errores" style="width:100%;height:400px;"></div>

    <script>
        // Cargar la lista de usuarios al cargar la página
        $(document).ready(function () {
            $.getJSON('/usuarios', function (usuarios) {
                var select = $('#usuario');
                $.each(usuarios, function (key, usuario) {
                    select.append('<option value="' + usuario.id + '">' + usuario.username + '</option>');
                });
            });
        });

        // Cargar gráficos para el usuario seleccionado
        function cargarGraficos() {
            var usuarioId = $('#usuario').val();
            $.getJSON('/datos_grafico/' + usuarioId, function (data) {
                Plotly.react('grafico_seno', JSON.parse(data.seno).data, JSON.parse(data.seno).layout);
                Plotly.react('grafico_coseno', JSON.parse(data.coseno).data, JSON.parse(data.coseno).layout);
                Plotly.react('grafico_fourier', JSON.parse(data.fourier).data, JSON.parse(data.fourier).layout);
                Plotly.react('grafico_errores', JSON.parse(data.errores).data, JSON.parse(data.errores).layout);
            });
        }
    </script>
</body>
</html>
